{% extends "base.html" %}
{% block content %}
<h2 class="mb-3">Operations</h2>


<div class="mb-3">
  {% if user.is_inventory_manager %}
  <a href="{% url 'inventory:receipt_create' %}" class="btn btn-outline-primary btn-sm me-2">+ Receipt</a>
  <a href="{% url 'inventory:delivery_create' %}" class="btn btn-outline-primary btn-sm me-2">+ Delivery</a>
  {% endif %}
  {% if user.is_warehouse_staff %}
  <a href="{% url 'inventory:internal_transfer_create' %}" class="btn btn-outline-primary btn-sm me-2">+ Internal Transfer</a>
  <a href="{% url 'inventory:stock_adjustment_create' %}" class="btn btn-outline-secondary btn-sm">+ Adjustment</a>
  {% endif %}
</div>

<form method="get" class="row g-2 align-items-end mb-3">
  <div class="col-md-3">
    <label class="form-label">Document type</label>
    <select name="doc_type" class="form-select">
      <option value="">All</option>
      {% for value,label in doc_type_choices %}
        <option value="{{ value }}" {% if value == selected_doc_type %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <label class="form-label">Status</label>
    <select name="status" class="form-select">
      <option value="">All</option>
      {% for value,label in status_choices %}
        <option value="{{ value }}" {% if value == selected_status %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <label class="form-label">Warehouse</label>
    <select name="warehouse" class="form-select">
      <option value="">All</option>
      {% for wh in warehouses %}
        <option value="{{ wh.id }}" {% if wh.id|stringformat:'s' == selected_warehouse %}selected{% endif %}>{{ wh.name }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-md-3">
    <button class="btn btn-primary w-100" type="submit">Apply Filters</button>
  </div>
</form>

<table class="table table-striped table-sm">
  <thead>
    <tr>
      <th>ID</th>
      <th>Type</th>
      <th>Reference</th>
      <th>From</th>
      <th>To</th>
      <th>Scheduled</th>
      <th>Status</th>
      <th>Created</th>
    </tr>
  </thead>
  <tbody>
  {% for doc in documents %}
    <tr>
      <td>{{ doc.id }}</td>
      <td>{{ doc.get_doc_type_display }}</td>
      <td>{{ doc.reference }}</td>
      <td>{{ doc.source_location }}</td>
      <td>{{ doc.destination_location }}</td>
      <td>{{ doc.scheduled_date|default:"-" }}</td>
      <td>
        <span class="badge bg-secondary">{{ doc.get_status_display }}</span>
      </td>
      <td>{{ doc.created_at|date:"Y-m-d H:i" }}</td>
    </tr>
  {% empty %}
    <tr><td colspan="8" class="text-muted">No operations found.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}


